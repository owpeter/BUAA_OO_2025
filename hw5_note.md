需要控制：电梯上下行，电梯开关门，乘客进出电梯

系统运行中乘客可以中途下电梯，系统结束时到达目的地即可

（本次作业）乘客只能进入和离开输入时指定的电梯，不可以进入其他电梯

不出现起点层和终点层相同的乘客请求。

# 策略类

首先为电梯规定一个初始方向，然后电梯开始沿着该方向运动。

到达某楼层时，首先判断是否需要开门
- 如果发现电梯里有人可以出电梯（到达目的地），则开门让乘客出去；
- 如果发现该楼层中有人想上电梯，并且目的地方向和电梯方向相同，则开门让这个乘客进入。

接下来，进一步判断电梯里是否有人。
- 如果电梯里还有人，则沿着当前方向移动到下一层。
- 如果电梯里没人，检查请求队列中是否还有请求（目前其他楼层是否有乘客想要进电梯）——
    - 如果请求队列不为空，且某请求的发出地是电梯"前方"的某楼层，则电梯继续沿着原来的方向运动。
    - 如果请求队列不为空，且所有请求的发出地都在电梯"后方"的楼层上，或者是在该楼层有请求但是这个请求的目的地在电梯后方（因为电梯不会开门接反方向的请求），则电梯掉头并进入"判断是否需要开门"的步骤（循环实现）。

如果请求队列为空，且输入线程没有结束（即没有输入文件结束符），则电梯停在该楼层等待请求输入（wait）。电梯在等待过程中，运行方向不发生改变

如果请求队列为空，且输入线程结束，则电梯线程结束

共返回5种策略，`KILL, MOVE, REVERSE, OPEN, WAIT`

策略类聚合在电梯类中，电梯每到达一个楼层都要询问策略类建议，根据建议执行动作

# 新策略类

- 策略类应考虑人数限制、是否到达最顶层或最底层，以及权重

为了在传统LOOK算法中引入优先级，同时尽量缩短运行距离，需调整请求处理顺序和方向决策。以下是修改后的算法步骤：

### 1. 请求队列管理
- **优先级排序**：所有请求（内部目的地和外部请求）附加优先级属性，队列按优先级降序排列，同优先级时距离近的优先。

### 2. 电梯运行规则
#### a. 初始方向设定
- 电梯启动时，若无历史请求，初始方向可任意（如上行）；否则选择最高优先级请求所在方向。
- ？初始方向默认为向上

#### b. 到达楼层时的操作
- **下客优先**：若当前楼层是某乘客目的地，无论优先级，必须开门让其下客。
- **上客策略**：允许同方向且目的地方向一致的乘客按优先级进入，直到满载或无可载乘客。

#### c. 移动决策
1. **电梯非空时**：
   - 继续当前方向，逐层检查停靠请求（传统LOOK逻辑）。
   - 在同方向的前方楼层中，若有更高优先级请求，仍按顺序移动，但优先处理该楼层请求。

2. **电梯空载时**：
   - 扫描所有未处理请求，选择最高优先级的请求所在方向。
   - 若该请求在反方向且优先级高于所有前方请求，则立即掉头。

3. **掉头条件**：
   - 当前方向无请求，或反方向存在更高优先级请求。

### 3. 综合权重计算
当电梯空载需选择方向时，计算请求的权重（如：优先级/距离），选择权重最高的方向，减少无效移动。

### 4. 处理冲突
- 同方向同优先级请求按距离排序。
- 反方向更高优先级请求触发掉头，但需计算综合收益（如总节省时间 vs. 额外距离）。

### 5. 动态调整
- 实时更新请求队列的优先级排序，确保电梯响应最新高优先级请求。

### 示例场景
- **场景1**：电梯在5层，空载。请求：3层（优先级5）、7层（优先级3）。计算权重：3层（5/2=2.5），7层（3/2=1.5）。电梯掉头向下，优先服务3层。
- **场景2**：电梯上行中，内部有8层（低）和9层（高）请求。保持上行，先停9层（若允许跳跃），否则按顺序停靠但优先处理9层请求。

### 结论
通过优先级调整请求队列和方向决策，电梯在保障高优先级任务的同时，尽可能沿高效路径移动，平衡了服务质量和运行效率。